---
layout: post
title:  ArchLinux 个人安装错误及解决
date:   2018-03-31 00:00:01
---

Arch Linux 是通用 x86-64 GNU/Linux 发行版。Arch Linux的哲学是“kiss”，即：keep it simple,stupid,对应的中文是“保持自然且一目了然”。也就是说Arch
的理念就是简洁而实用。但是，与流行的Ubuntu相比，Arch的用户群体相对较小，这就意味着在折腾的时候没有很多的经验可以参考，可以说是除了Arch的官方文档的之外
没有更加详细而全面的资料了。

Arch的官方Wiki内容非常详实，从安装到各种设置应有尽有。如果我们能够把官方文档认真读懂的话安装应该不会有很大的问题。但是本人在安装的时候因为急于求成没有
认真阅读文档，所以导致在安装过程中出现了各种各样的错误，所以在这里主要用这篇文章来梳理一下安装过程中的错误和解决方案，供大家参考。

## 一 安装准备

这一步和安装任何一个Linux发行版一样，需要制作安装介质，推荐制作usb启动盘。

## 二 BIOS设置

将制作好的U盘插在电脑上，然后重启，在开启后第一次出现logo的时候按下f2键进入BIOS选项（在此电脑型号为dell，不同品牌的电脑可能不同）。然后在boot sequence
选项中选择ufei启动，并且把启动盘的开机顺序调整到第一位。

## 三 连接到因特网

BIOS设置成功的话重启后就会进入到选择画面，选择第一个选项并回车。
经过一些加载之后就会进入安装环境。第一件事就是要连接互联网，这一点非常重要，因为Arch的安装过程要求全程联网。可以连接有线网和无线网，由于笔者在安装的时候
是在校园网环境下，需要账号密码，所以果断选择连接无线，但是连接可能会失败，这个时候不要着急，可以按照以下步骤手动设置。

假设本机的无线接口名为wlan0

获得本机的无线接口名：

  $ iw dev
    
  phy#0 Interface wlan0 
    
  ifindex 3 wdev 0x1
    
  addr 12:34:56:78:9a:bc 
    
  type managed 
    
  channel 1 (2412 MHz), width: 40 MHz, center1: 2422 MHz
    
检查连接状态：
  
  $ iw dev wlan0 link

如果没有连接会显示：not connected

激活内核接口：

  # ip link set wlan0 up
  
运行命令 # ip link show wlan0
来确保接口的确打开了。

查看可用的无线网络：

  # iw dev wlan0 scan |less

此命令输出的信息即是可以连接的无线网信息，需要关注每个网络的这几个信息：

SSID 网络的名称

Signal 无限信号强度，数值越接近于零信号越好。

Security 有无密码

连接无线网：

  # iw wlan0 connect SSID  ##无加密的网络
 
  # wpa_supplicant -i interface -c <(wpa_passphrase your_SSID your_key)  ##如果加密方式是WPA或WPA2

此时再次检查连接状态：

  $ iw dev wlan0 link
  
如果显示出连接网络的相关信息就表明连接成功了。

## 四 更新系统时间

略

## 五 建立磁盘分区及格式化

Arch的安装全部是以命令行的形式，和Ubuntu的图形界面有很大不同，但是根据官方文档提供的硬盘分区工具进行硬盘分区还是很方便的，这里不在赘述。

在这里是EFI/GPT方式引导，并且同时安装了其他系统，那么应该可以在分区列表中发现一个较小的并且类型为EFI的分区（注意查看硬盘的大小，这个EF
I分区有可能是你U盘中的，需要排除），这是你的引导分区，请记下它的路径（/dev/sdxY)备用。

## 六 挂载分区：

这一步也没有什么好说的，按照文档操作即可，需要注意一点，如果需要挂在的目录不存在，需要先创建目录在挂载。其实除了根目录，需要挂载的其他所有目录都是
需要创建的。

需要特别注意的是，因为这次安装时EFI/GPT方式引导，所以在挂载是需要创建一个/boot的目录，并且把efi引导分区挂载在这里。

## 七 安装镜像

记得在安装之前修改一下镜像源，建议优先选择科大源、浙大源、清华源等。然后按照官方文档操作即可。

## 八 配置系统

包括设置时区、locale、主机名、网络配置等，按照官方文档操作即可。

## 九 安装引导程序

安装grub和efibootmgr两个包：
  
  pacman -S grub efibootmgr
  
部署grub

  grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=grub
  
生成配置文件：

  grub-mkconfig -o /boot/grub/grub.cfg
  
（如果不是efi引导安装，引导程序的安装不同，注意）

## 十 重启

安装成功重启后即可进入系统。

至此安装过程完成，但是在安装完成后还需要进行大量的配置工作，因为Arch的理念是简洁，
所以它除了光秃秃的系统之外什么都不会给我们装，我们什么都需要自己设置，这又是一项繁琐的任务。
  
